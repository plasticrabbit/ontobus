онтология authorization

magnet-ontology#RightRecord

magnet-ontology#authorSystem - система выдающая право, "BA"/"DOCFLOW"
magnet-ontology#authorSubsystem - "user"/routeName
magnet-ontology#authorSubsystemElement - id user or id route.

magnet-ontology#category категория элемента, на который выдаются права (DOCUMENT, DOCUMENTTYPE, DICTIONARY и т. д.).

magnet-ontology#targetSystem - система, для которой выдали права, "BA"/"DOCFLOW".
magnet-ontology#targetSubsystem - "user"/"department".
magnet-ontology#targetSubsystemElement - user id or department id.

magnet-ontology#elementId - идентификатор элемента, на который выдаются права.

magnet-ontology#dateTo период действия прав (до (с возможностью указания открытых интервалов значение null)).
magnet-ontology#dateFrom - период действия прав (от (с возможностью указания открытых интервалов- значение null)).
magnet-ontology#rigths> "c|r|u|d"



ответы с ожидаются с result:data

1. обновление, создание, удаление записей прав

Используется для создания/обновления/удаления записей прав доступа. В качестве параметров передается список триплетов, первый из которых содержит
имя запрашиваемой операции(create|update|delete), остальные служат параметрами для операции. В случае, если операция == create создается новая запись
с триплетами переданными в аргументе, идентификатор записи создается на стороне semargl и возвращается в качестве результата. В случае, если 
операция == update обновляется запись триплетами, переданными в аргументе. В случае, если операция == delete удаляются записи соответствующие шаблону
переданному в аргументе, если триплет шаблона не содержит данных в объекте, то он не участвует в сравнении.

отправляю:

	<subject><put><uid1>.
		<uid1><argument>{
			<operation><name>"create|update|delete".
			<recId><magnet-ontology#authorSystem>"".
			<recId><magnet-ontology#authorSubsystem>"".
			<recId><magnet-ontology#authorSubsystemElement>"".
			<recId><magnet-ontology#targetSystem>"".
			<recId><magnet-ontology#targetSubsystem>"".
			<recId><magnet-ontology#targetSubsystemElement>"".
			<recId><magnet-ontology#category>"".<recId><magnet-ontology#elementId>"".<recId><magnet-ontology#rights>"".
		}.

ожидаю: 

	идентификатор созданной/обновленной записи


2. get_authorization_rights_records

Используется для получения записей прав соответствующих определенному шаблону. Шаблон - набор триплетов, которые входят в состав записи права.
Если запись права содержит заданные в шаблоне триплеты, значит она должна быть включена в результат. Если какие-то из триплетов шаблона содержат
пустые значения объектов, либо отсутствуют в запросе, значит их нужно проигнорировать при сравнении. 

запрос:

	<subject><get_authorization_rights_records>"uid1".
		<uid1><argument>{
			<recId><magnet-ontology#authorSystem>"".
			<recId><magnet-ontology#authorSubsystem>"".
			<recId><magnet-ontology#authorSubsystemElement>"".
			<recId><magnet-ontology#targetSystem>"".
			<recId><magnet-ontology#targetSubsystem>"".
			<recId><magnet-ontology#targetSubsystemElement>"".
			<recId><magnet-ontology#category>"".
			<recId><magnet-ontology#elementId>"".
		}.


ответ:
триплеты записей прав

	<magnet-ontology#RightsRecord5><magnet-ontology#authorSystem>"BA".                                                           
	<magnet-ontology#RightsRecord5><magnet-ontology#authorSubsystem>"user".                                                           
	<magnet-ontology#RightsRecord5><magnet-ontology#authorSubsystemElement>"aa8d1a71a2e34303954ced25d1037cdf".
	...

2. обновление, создание, удаление записей прав

Используется для создания/обновления/удаления записей прав доступа. В качестве параметров передается список триплетов, первый из которых содержит
имя запрашиваемой операции(create|update|delete), остальные служат параметрами для операции. В случае, если операция == create создается новая запись
с триплетами переданными в аргументе, идентификатор записи создается на стороне semargl и возвращается в качестве результата. В случае, если 
операция == update обновляется запись триплетами, переданными в аргументе. В случае, если операция == delete удаляются записи соответствующие шаблону
переданному в аргументе, если триплет шаблона не содержит данных в объекте, то он не участвует в сравнении.

запрос:

	<subject><put><uid1>.
		<uid1><argument>{
			<operation><name>"create|update|delete".
			<recId><magnet-ontology#authorSystem>"".
			<recId><magnet-ontology#authorSubsystem>"".
			<recId><magnet-ontology#authorSubsystemElement>"".
			<recId><magnet-ontology#targetSystem>"".
			<recId><magnet-ontology#targetSubsystem>"".
			<recId><magnet-ontology#targetSubsystemElement>"".
			<recId><magnet-ontology#category>"".<recId><magnet-ontology#elementId>"".<recId><magnet-ontology#rights>"".
		}.

ответ: 

	идентификатор созданной/обновленной записи


3. authorize

Используется для проверки доступа пользователя к объектам системы. 

запрос: 
	<subject><authorize><uid1>.<uid1><right>"c|r|u|d".
	<uid1><category>"DOCUMENT | DOCUMENTTYPE | USER | DICTIONARY | DRAFT | USERGROUP | DEPARTMENTASSOCIATION".
	<uid1><elements>"elementId".<uid1><targetId>"targetId"."

ответ:
список id элементов, к которым разрешен доступ, разделенных запятой:
	id1, id3


4. add_delegate

Добавляет делегата для пользователя, если установлен флаг withTree, значит делегат так же принимает делегированные owner'у права.
Возвращает идентификатор записи делегирования.

запрос:
	<subject><add_delegates><uid1>.
		<uid1><argument>{
			<delegateRecord1><owner>"userId1".
			<delegateRecord1><delegate>"userId2".
			<delegateRecord1><withTree>"true".
		}.

ответ: 
	delegateRecord1Id


5. remove_delegate

Удаляет запись делегирования соответствующую шаблону без учета идентификатора записи(от кого - кому).

запрос:
	<subject><remove_delegate><uid1>.<uid1><argument>"<delegateRecord1><owner>"userId1".".

	
6. get_delegate_assigners

Используется для получения списка пользователей делегировавших права пользователю с переданным в аргументе идентификатором.

запрос:
	<subject><get_delegate_assigners><uid1>.<uid1><argument>"userId1".

ответ:
	список идентификаторов делегировавших без учета дерева делегирования(через запятую)

	
7. get_delegate_assigners_tree

Используется для получения списка пользователей делегировавших права пользователю с переданным в аргументе идентификатором с учетом дерева делегатов.

запрос:
	<subject><get_delegate_assigners><uid1>.<uid1><argument>"userId1".

ответ:
	список идентификаторов делегатов c учетом дерева делегирования(через запятую)

8. is_in_docflow

Используется для того, чтобы выяснить, находится документ в документообороте(идет ли по какому-либо маршруту) или нет. 
Документ находится в документообороте, если существуют записи прав соответствующие шаблону: 

			<magnet-ontology#authorSystem> = "DOCFLOW"
			<magnet-ontology#category> = "DOCUMENT"
			<magnet-ontology#elementId> = идентификатору документа для которого выполняется метод

запрос:

	<subject><is_in_docflow><uid1>.<uid1><argument>"docId1".

ответ:

	true | false
